---
import Layout from '../layouts/Layout.astro';
import HomeHeroSection from '../components/sections/heros/HomeHeroSection.astro';
import Container from '../components/Container.astro';
import { getCollection } from 'astro:content';
import { Image } from "astro:assets";
import type { ImageMetadata } from 'astro';


	const posts_project = (await getCollection('project'))
	.sort((a: { data: { pubDate: number; }; }, b: { data: { pubDate: number; }; }) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf()).reverse();

	const posts_project_featured = (await getCollection('project'))
	.filter((post: { data: { status: string; }; }) => post.data.status == 'featured') // Filter out active posts
	.sort((a: { data: { pubDate: number; }; }, b: { data: { pubDate: number; }; }) => a.data.pubDate.valueOf() - b.data.pubDate.valueOf());
---
<Layout title="t2del" meta_description="Dennis Macapagal" body_class="home" image="favicon.ico">
	<HomeHeroSection />

	<section id="portfolio">			
		<Container className="container-portfolio">
			<h2 class="notshow fromleft"> <span class="text-gradient">Projects</span></h2>
			<ul role="list" class="link-card-grid featured">
				{
					posts_project_featured.map((post: { slug: string | null | undefined; data: { heroImage: string | ImageMetadata | Promise<{ default: ImageMetadata; }>; title: unknown; }; }) => (
						<li class="notshow blur portfolio-list"  id={post.slug}>
							<a href={`/project/${post.slug}`}>
								<Image  
									src={post.data.heroImage}
									alt={post.data.title} 
									width={350} 
									height={180} 
									format='webp'									 
									loading="eager"
								>
								</Image>
								<h4>{post.data.title}</h4>
							</a>
						</li>
					))
				}				
			</ul>
			<ul role="list" class="link-card-grid">
				{
					posts_project.map((post: { data: { status: string; heroImage: string | ImageMetadata | Promise<{ default: ImageMetadata; }>; title: unknown; }; slug: string | null | undefined; }) => {
						if (post.data.status == 'active') {
							return (
								<li class="notshow blur portfolio-list"  id={post.slug}>
									<a href={`/project/${post.slug}`}>
										<Image 
											src={post.data.heroImage} 
											width={350} 
											height={180} 
											format='webp' 
											alt={post.data.title} 
											loading="eager">
										</Image>
										<h4>{post.data.title}</h4>
									</a>
								</li>
							);
						}
						return null;
					})
				}
			</ul>							
		</Container>
	</section>
</Layout>